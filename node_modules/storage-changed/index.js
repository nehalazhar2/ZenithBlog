"use strict";var _storageUtilities=_interopRequireDefault(require("storage-utilities"));Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;function _interopRequireDefault(a){return a&&a.__esModule?a:{default:a}}var emit=function(a,b,c){return new Promise(function(){var d=0,e=setInterval(function(){d++>=c.timeout&&clearInterval(e);var f=new CustomEvent(c.eventName,{detail:b});a[b.key]===b.value&&(window.dispatchEvent(f),clearInterval(e))},10)})},getEventName=function(a){return a.eventName||a.targetName+"StorageChanged"},getTimeout=function(a){return a.timeout?a.timeout/10:15},getTarget=function(a){return"string"==typeof a?window["".concat(a,"Storage")]:a},getTargetName=function(a){return"string"==typeof a?"session"===a?"session":"local":a===window.sessionStorage?"session":"local"},_default=function(a,b){var c=b||{};c.targetName=getTargetName(a),c.eventName=getEventName(c),c.timeout=getTimeout(c);var d=getTarget(a),e=d.setItem.bind(d),f=d.removeItem.bind(d);d.setItem=function(a,b){var f=_storageUtilities.default.stringify(b);emit(d,{key:a,value:f,_target:c.targetName},c),e(a,f)},d.removeItem=function(a){emit(d,{key:a,_target:c.targetName},c),f(a)}};exports.default=_default;
